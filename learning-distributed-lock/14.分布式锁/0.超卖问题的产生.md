超卖
实际库存100件货物,被下单101件,一般发生于秒杀等活动中；会造成实际的金钱利益损害。
现象: 系统只有1件商品，被下了两个订单
发生的原因：

1. 系统只剩下1件商品
2. 小明和小白同时下单并支付成功
3. 系统产生两笔下单成功订单

程序进行库存扣减还没完成的时候，一个新的下单线程也进行支付，并发场景下易发生。



解决方案

- 扣减库存不通过系统，采用数据库
- 数据库传递库存增量，扣减一个库存，增量-1
- 数据库 update 语句计算库存，行锁解决并发带来的问题


单体应用锁
分布式锁
    Redis
    Zookeeper
    Redisson
    
单体系统
synchronized method + 手动控制事务
synchronized代码块
    1. this 当锁
    2. 当前类定义一个对象变量当锁,1和2一样的原理通过对象当锁,单例情况下有效,多例还是存在超卖问题
    3. 当前类当锁(推荐),只有一个





